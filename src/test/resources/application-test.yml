spring:
  config:
    activate:
      on-profile: test-postgres
  datasource:
    url: jdbc:tc:postgresql:15-alpine:///review_system_test?loggerLevel=DEBUG
    driver-class-name: org.testcontainers.jdbc.ContainerDatabaseDriver
    username: test
    password: test
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        generate_statistics: false
    database-platform: org.hibernate.dialect.PostgreSQLDialect
  flyway:
    enabled: true
    locations: classpath:db/migration
    clean-disabled: false
    clean-on-validation-error: true
  h2:
    console:
      enabled: true

# AWS Configuration for LocalStack
aws:
  s3:
    bucketName: test-reviews-bucket
    region: us-east-1
    prefix: reviews/
    accessKey: test
    secretKey: test
    max-retries: 3
    retry-delay-ms: 100 # Faster retries for tests
    connection-timeout: PT5S # 5 seconds
    read-timeout: PT10S # 10 seconds
    path-style-access: true
    endpoint: # Will be overridden by @DynamicPropertySource
# Retry configuration
spring.retry:
  enabled: true

# Test-specific configurations
test:
  s3:
    test-data-path: "classpath:test-data/"
    sample-files:
      - "sample-reviews.jl"
      - "malformed-reviews.jl"
      - "large-reviews.jl"

logging:
  level:
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
    com.reviewsystem: DEBUG
